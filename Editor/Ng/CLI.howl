⊓ Active.Howl{
‒ ○ CLI{

    ㅇ dry;
    DotNet δ = ⌢ DotNet();

    ‒ CLI(ㅇ dry) → ⦿.dry = dry;

    ‒̥ ┈ Main(ㄹ[] ㅂ){
        🐰 "Howl CLI v0.0.10";
        🐰 ⌢ CLI(dry: ✗).Parse(ㅂ);
    }

    ㄹ Parse(ㄹ[] ㅂ){
        ⤴ (ㅂ❙ < 1) ⮐ help;
        ⤭ (ㅂ[0]){
            ⥰ "build"   : Build   (ㅂ); ¦
            ⥰ "export"  : Export  (ㅂ); ¦
            ⥰ "import"  : Import  (ㅂ); ¦
            ⥰ "publish" : Publish (ㅂ); ¦
            ⥰ "run"     : Run     (ㅂ); ¦
            ～: ⮐ $"Unrecognized command [{ㅂ[0]}]";
        }
        ⮐ "...all done";
    }

    ‒ ㄹ Build(⋯ ㄹ[] ㅂ){
        ㄹ ι = ∅, π = ㅂ[1], Π = π.FullPath(), ω =  $"{π}/build";
        ω.RmDir(dry);
        ι += Export(∅, π, ω);
        ι += δ.New($"console --name build --force", Π, ω, dry);
        ι += δ.Build("build", Π, dry);
        ⮐ ι;
    }

    ‒ ㄹ Export(⋯ ㄹ[] ㅂ){
        ㄹ src = ㅂ[1].WithFinalSep(),
          dst = ㅂ[2].WithFinalSep();
        ⤴ (!src.IsDir()) ⮐ $"Source dir not found: {src}\n";
        ∙ paths = FileSystem.Paths(src, "*.howl");
        ⤴ (dry){
            ⮐ ∅;
        }
        ∀ (∙ x ∈ paths){
            ∙ y = dst + x.RelativeTo(src).SetExtension(".cs");
            🐰y;
            Howl.BuildFile(x, y);
        }
        ⮐ "Exported some files";
    }

    ‒ ㄹ Publish(⋯ ㄹ[] ㅂ){
        ㄹ ι = ∅;
        ㄹ π = ㅂ[1], Π = π.FullPath(), ω =  $"{π}/build";
        ω.RmDir(dry);
        ι += Export(∅, π, ω);
        ι += δ.New($"console --name build --force", Π, ω, dry);
        ι += δ.Publish("build", Π, rt: ∅, dry);
        ⮐ ι;
    }

    ‒ ㄹ Run(⋯ ㄹ[] ㅂ){
        ㄹ π = ㅂ[1], Π = π.FullPath(), ω =  $"{π}/build";
        ω.RmDir(dry);
        Export(∅, π, ω);
        δ.New($"console --name build --force", Π, ω, dry);
        δ.Run("--project build", Π, dry);
        ⮐ ∅;
    }

    ㄹ Import(ㄹ[] ㅂ) → 🐤 "Unimplemented";

    ㄹ help =
@"Usage:
howl export SRC_DIR DST_DIR - Export Howl scripts to C#
howl import SRC_DIR DST_DIR - Convert C# scripts to Howl [n/a]
howl build DIR              - Build a console app
howl publish DIR            - Build and publish a console app
howl run DIR                - Build and run a console app
";

}}
