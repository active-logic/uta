âŠ System;
âŠ System.IO; âŠ System.Linq; âŠ Dir = System.IO.Directory;
âŠ SysPath = System.IO.Path;
âŠ System.Runtime.Serialization.Formatters.Binary;

âŠ“ Active.Howl{
â€’Ì¥ â—‹ IO{

    â€’Ì¥  DateTime DateModified(â¦¿ ã„¹ Ï€) â†’ File.GetLastWriteTime(Ï€);

    â€’Ì¥ â”ˆ Delete(â¦¿ ã„¹ Ï€, ã…‡ withMetaFile){
        File.Delete(Ï€);
        â¤´ (withMetaFile) Ï€.MetaFile()?.Delete(withMetaFile: âœ—);
    }

    â€’Ì¥ â”ˆ CopyFiles(â¦¿ ã„¹ ã…‚, ã„¹ ã„¸, ã„¹ relTo, ã…‡ dry, params ã„¹[] patterns){
        âˆ€ (âˆ™ Ï€ âˆˆ patterns){
            âˆ™ Ïƒ = FileSystem.Paths(ã…‚, Ï€);
            âˆ€ (âˆ™ Ï† âˆˆ Ïƒ) Ï†.CopyTo($"{ã„¸}/{Ï†.RelativeTo(relTo)}", dry);
        }
    }

    â€’Ì¥ â”ˆ MoveFiles(â¦¿ ã„¹ ã…‚, ã„¹ ã„¸, ã„¹ relTo, ã…‡ dry, params ã„¹[] patterns){
        âˆ€ (âˆ™ Ï€ âˆˆ patterns){
            âˆ™ Ïƒ = FileSystem.Paths(ã…‚, Ï€);
            âˆ€ (âˆ™ Ï† âˆˆ Ïƒ) Ï†.Rename($"{ã„¸}/{Ï†.RelativeTo(relTo)}", dry);
        }
    }

    â€’Ì¥ â”ˆ CopyTo(â¦¿ ã„¹ ã…‚, ã„¹ ã„¸, ã…‡ dry=âœ—){
        â¤´ (dry){} // Print($"Copy {ã…‚.RelativeTo("Assets")} -> {ã„¸}");
        â¤µ File.Copy(ã…‚, ã„¸);
    }

    â€’Ì¥ ã…‡ Exists(â¦¿ ã„¹ Ï€) â†’ File.Exists(Ï€) âˆ¨ Directory.Exists(Ï€);

    â€’Ì¥ ã„¹ FileName(â¦¿ ã„¹ Ï€) â†’ SysPath.GetFileName(Ï€);

    â€’Ì¥ ã„¹[] Files(â¦¿ ã„¹ Ï€) â†’ Directory.GetFiles(Ï€);

    â€’Ì¥ ã„¹[] Dirs(â¦¿ ã„¹ Ï€) â†’ Directory.GetDirectories(Ï€);

    â€’Ì¥ ã„¹ DirName(â¦¿ ã„¹ Ï€) â†’ SysPath.GetDirectoryName(Ï€).Nix();

    â€’Ì¥ ã…‡ IsDir(â¦¿ ã„¹ Ï€) â†’ Directory.Exists(Ï€);

    â€’Ì¥ ã…‡ IsFile(â¦¿ ã„¹ Ï€) â†’ File.Exists(Ï€);

    â€’Ì¥ DirectoryInfo MkDir (â¦¿ ã„¹ Ï€) â†’ Dir.CreateDirectory(Ï€);

    â€’Ì¥ ã„¹ Read(â¦¿ ã„¹ Ï€) â†’ File.ReadAllText(Ï€);

    â€’Ì¥ â”ˆ Rename(â¦¿ ã„¹ ã…‚, ã„¹ ã„¸, ã…‡ withMetaFile){
        ã„¸.DirName().MkDir();
        File.Move(ã…‚, ã„¸);
        ã„¹ m0 = ã…‚.MetaFile();
        ã„¹ m1 = ã„¸.PathToMetaFile();
        ğŸ¥($"ã„¸ is {ã„¸}");
        ğŸ¥($"IO.Rename( {m0} --> {m1} )");
        â¤´ (m0.Exists()) File.Move(m0, m1);
    }

    â€’Ì¥ â”ˆ RmDir(â¦¿ ã„¹ Ï€){
        if(!Ï€.IsDir()) â® ;
        âˆ€ (âˆ™ Îº âˆˆ Ï€.Files ()) Îº.Delete(withMetaFile: âœ“);
        âˆ€ (âˆ™ Îº âˆˆ Ï€.Dirs  ()) Îº.RmDir();
        Ï€.MetaFile()?.Delete(withMetaFile: âœ—);
        Directory.Delete(Ï€);
    }

    â€’Ì¥ ã„¹[] ReadLines(â¦¿ ã„¹ Ï€) â†’ File.ReadLines(Ï€)à§´;

    â€’Ì¥  T ReadObject<T>(â¦¿ ã„¹ Ï€){
        âˆ™ Ï† = âŒ¢ BinaryFormatter();
        âˆ™ s    = âŒ¢ FileStream(Ï€,  FileMode.Open, FileAccess.Read);
        âˆ™ @out = Ï†.Deserialize(s);
        s.Close();
        â® (T)@out;
    }

    â€’Ì¥  T ReadObject<T>(â¦¿ ã„¹ Ï€, T @default)
    â†’ Ï€.Exists() ? Ï€.ReadObject<T>() : @default;

    â€’Ì¥ â”ˆ Write(â¦¿ ã„¹ Ï€, ã„¹ text, ã…‡ mkdir=âœ—, ã…‡ importAsset=âœ—){
        â¤´ (mkdir) Directory.GetParent(Ï€).Create();
        File.WriteAllText(Ï€, text);
        â¤´ (importAsset) UnityEditor.AssetDatabase.ImportAsset(Ï€);
    }

    â€’Ì¥ â”ˆ Write(â¦¿ ã„¹ Ï€, ã„¹ text, System.DateTime date){
        Directory.GetParent(Ï€).Create();
        File.WriteAllText(Ï€, text);
        File.SetLastWriteTime(Ï€, date);
    }

    â€’Ì¥  â”ˆ WriteObject(â¦¿ ã„¹ Ï€, object @out){
        âˆ™ Ï† = âŒ¢ BinaryFormatter();
        âˆ™ s = âŒ¢ FileStream(Ï€, FileMode.Create, FileAccess.Write);
        Ï†.Serialize(s, @out);
        s.Close();
    }

    âˆ˜ â”ˆ Print(ã„¹ x) â†’ ğŸ¥(x);

}}
