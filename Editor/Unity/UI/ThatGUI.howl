âŠ System;
âŠ App = UnityEngine.Application;
âŠ UnityEngine; âŠ UnityEditor; âŠÌ¥ UnityEngine.GUILayout;
âŠÌ¥ UnityEngine.Color; âŠÌ¥ UnityEditor.EditorStyles;
âŠ EGL = UnityEditor.EditorGUILayout; âŠ UGUI = UnityEngine.GUI;
âŠ EGU = UnityEditor.EditorGUIUtility;
âŠ C = Active.Howl.Config; âŠ S = Active.Howl.UIStrings;
âŠÌ¥ Active.Howl.UI.Widgets;

âŠ“ That{ â€’Ì¥ â—‹ GUI{

    âˆ˜ Color lightGray = Color.white * 0.5f;

    // TODO migrate
    á´¸ ã„¹ AssetStore = "https://assetstore.unity.com/packages";

    â€’Ì¥ ã…‡ flex{ â•­{ FlexibleSpace(); ã†‘ } }

    â€’Ì¥ ã…‡ A(ã„¹ label, ã„¹ url, á† width = -1){
        ã…‡ ã„¸ = width < 0 ? Button(label) : Button(label, Width(width));
        â¤´ (ã„¸){ App.OpenURL(url); ã†‘ }
        â¤µ â¤¬
    }

    â€’Ì¥ ã…‡ B(ã„¹ label, â’œ X = âˆ…){
        â¤´ (Button(label)){ â¤´(X â‰  âˆ…) X(); ã†‘ }
        â¤µ â¤¬
    }

    â€’Ì¥ ã…‡ Badge(ã„¹ label, ã„¹ ã„¸, á† w=24, Color? bg = âˆ…, Color? fg = âˆ…){
        âˆ™ oldbg = UGUI.backgroundColor;
        âˆ™ style = âŒ¢ GUIStyle(UGUI.skin.button);
        style.normal.textColor = fg ?? Color.black;
        UGUI.backgroundColor = bg ?? Color.white;
        ã…‡ ã…‚ = w > 0 ? Button(label, style, Width(24))
                     : Button(label, style);
        â¤´(ã…‚) Application.OpenURL(ã„¸);
        UGUI.backgroundColor = oldbg;
        ã†‘
    }

    â€’Ì¥ ã…‡ Br(á† space=8){ GUILayout.Space(space); ã†‘ }

    â€’Ì¥ ã…‡ P(ã„¹ label, GUIStyle style=âˆ…, â‹¯ GUILayoutOption[] opt){
        â¤´ (style â‰  âˆ…) Label(label, style, opt);
        â¤µ Label(label, opt);
        ã†‘
    }

    â€’Ì¥ Scope H
       { â•­{ BeginHorizontal(); â® (x) â†’ { EndHorizontal(); ã†‘ }; } }

    â€’Ì¥ ã…‡ Hd(ã„¹ s, á† top = 8, á† bottom = 4){
        â¤´ (s â˜° âˆ…) ã†‘
        Space(top);
        â¤´ (s â˜° "Active Logic") LinkToAL(s);
        â¤µ Label(s, boldLabel);
        Space(bottom);
        ã†‘
    }

    â€’Ì¥ ã…‡ Hr(á† w = 2, á† padding = 10, á† count = 1){
        âŸ³ (á† i = 0; i < count; i++){
            âˆ™ r = EGL.GetControlRect(Height(padding + w));
            r.height = w; r.x -= 2; r.width += 6; r.y += padding/2;
            EditorGUI.DrawRect(r, lightGray);
        } ã†‘
    }

    // TODO migrate
    â€’Ì¥ â”ˆ LinkToAL(ã„¹ header){
        BeginHorizontal();
        BeginVertical();
        Label(header, boldLabel);
        Label("Behavior Tree Library for C# 7",
              miniLabel);
        EndVertical();
        FlexibleSpace();
        Badge("GET!",
              $"{AssetStore}/tools/ai/active-logic-151850", -1);
        EndHorizontal();
    }

    â€’Ì¥ ã…‡ Tg(ã„¹ label, ref ã…‡ property)
       { property = Toggle(property, label); ã†‘ }

    â€’Ì¥ ã…‡ Tg(ã„¹ label, â’œ<ã…‡> Setter, â’¡<ã…‡> Getter)
       { Setter( Toggle(Getter(), label)); ã†‘ }

    â€’Ì¥ Scope V{â•­{ BeginVertical(); â® (x) â†’ { EndVertical(); ã†‘ }; }}

    â€’Ì¥ EditorWindow W<T>(ã„¹ title) Â¿ T : EditorWindow
       â†’ EditorWindow.GetWindow<T>(title: title);

    // ---------------------------------------------------------------

    â€’Ì¥ whenGate when(ã…‡ cond){
        EditorGUI.BeginDisabledGroup(!cond);
        â® âŒ¢ whenGate();
    }

    // Implementation ================================================

    â€’ ğ‹† ã…‡ Scope(â‹¯  âŠ¡[] args);

    â€’ readonly âŠŸ whenGate{
        â€’ ã…‡ â¦¿[â‹¯ âŠ¡[] Î»]{
            â•­{ EditorGUI.EndDisabledGroup(); ã†‘ }
        }
    }

}}
